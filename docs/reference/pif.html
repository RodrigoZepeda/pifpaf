<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Estimates the potential impact fraction, pif, for
individual-level exposure data (and covariates), X, from a
cross-sectional survey. Exposure is assumed to be associated with
a relative risk function, rr, with parameter theta. A counterfactual
scenario as a function of the exposure cft is assumed.
The potential impact fraction is defined Chan et al. (2023)
:


\[
 \text{PIF} = \dfrac{\mathbb{E}\Big[RR(X;\theta)\Big] -
   \mathbb{E}\Big[RR\big(\text{cft}(X);\theta\big)\Big]}{\mathbb{E}\Big[RR(X;\theta)\Big]}
\]
where:
\(X\) denotes the individual-level matrix of exposure and covariates,
\(\theta\) represents additional parameters of the relative risk function,
\(RR(X,\theta)\) denotes the relative risk of exposure (and covariates) at level
\(X\) given parameters \(\theta\),
\(cft(X)\) denotes the counterfactual function applied to exposure and covariates,
\({\mathbb{E}\Big[RR(X;\theta)\Big]}\) and
\({\mathbb{E}\Big[RR(\text{cft}(X);\theta)\Big]}\) denote the population average relative
risk under current (observed) conditions and the relative risk under the counterfactual scenario.
\(\text{PIF}\) represents the potential impact fraction.

"><title>Potential Impact Fraction — pif • pifpaf</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Potential Impact Fraction — pif"><meta property="og:description" content="Estimates the potential impact fraction, pif, for
individual-level exposure data (and covariates), X, from a
cross-sectional survey. Exposure is assumed to be associated with
a relative risk function, rr, with parameter theta. A counterfactual
scenario as a function of the exposure cft is assumed.
The potential impact fraction is defined Chan et al. (2023)
:


\[
 \text{PIF} = \dfrac{\mathbb{E}\Big[RR(X;\theta)\Big] -
   \mathbb{E}\Big[RR\big(\text{cft}(X);\theta\big)\Big]}{\mathbb{E}\Big[RR(X;\theta)\Big]}
\]
where:
\(X\) denotes the individual-level matrix of exposure and covariates,
\(\theta\) represents additional parameters of the relative risk function,
\(RR(X,\theta)\) denotes the relative risk of exposure (and covariates) at level
\(X\) given parameters \(\theta\),
\(cft(X)\) denotes the counterfactual function applied to exposure and covariates,
\({\mathbb{E}\Big[RR(X;\theta)\Big]}\) and
\({\mathbb{E}\Big[RR(\text{cft}(X);\theta)\Big]}\) denote the population average relative
risk under current (observed) conditions and the relative risk under the counterfactual scenario.
\(\text{PIF}\) represents the potential impact fraction.

"><meta property="og:image" content="https://rodrigozepeda.github.io/pifpaf/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-secondary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">pifpaf</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Biostatistics.html">How the methods work (biostatistics)</a>
    <a class="dropdown-item" href="../articles/Collection-of-examples.html">Collection of examples</a>
    <a class="dropdown-item" href="../articles/Epidemiology-101.html">Epidemiology 101: The attributable and impact fractions</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="http://twitter.com/RodZepeda" aria-label="Twitter">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Potential Impact Fraction</h1>
      
      <div class="d-none name"><code>pif.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Estimates the <strong>potential impact fraction</strong>, <code>pif</code>, for
<strong>individual-level exposure</strong> data (and covariates), <code>X</code>, from a
cross-sectional survey. Exposure is assumed to be associated with
a <strong>relative risk</strong> function, <code>rr</code>, with parameter <code>theta</code>. A <strong>counterfactual</strong>
scenario as a function of the exposure <code>cft</code> is assumed.</p>
<p>The <strong>potential impact fraction</strong> is defined Chan et al. (2023)
:
<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>

\[
 \text{PIF} = \dfrac{\mathbb{E}\Big[RR(X;\theta)\Big] -
   \mathbb{E}\Big[RR\big(\text{cft}(X);\theta\big)\Big]}{\mathbb{E}\Big[RR(X;\theta)\Big]}
\]</p>
<p>where:</p><ul><li><p><em></em>\(X\) denotes the individual-level matrix of exposure and covariates,</p></li>
<li><p><em></em>\(\theta\) represents additional parameters of the relative risk function,</p></li>
<li><p><em></em>\(RR(X,\theta)\) denotes the relative risk of exposure (and covariates) at level
<em></em>\(X\) given parameters <em></em>\(\theta\),</p></li>
<li><p><em></em>\(cft(X)\) denotes the counterfactual function applied to exposure and covariates,</p></li>
<li><p><em></em>\({\mathbb{E}\Big[RR(X;\theta)\Big]}\) and
<em></em>\({\mathbb{E}\Big[RR(\text{cft}(X);\theta)\Big]}\) denote the population average relative
risk under current (observed) conditions and the relative risk under the counterfactual scenario.</p></li>
<li><p><em></em>\(\text{PIF}\) represents the potential impact fraction.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">pif</span><span class="op">(</span></span>
<span>  <span class="va">design</span>,</span>
<span>  <span class="va">theta</span>,</span>
<span>  <span class="va">rr</span>,</span>
<span>  cft <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">additional_theta_arguments</span>,</span>
<span>  n_bootstrap_samples <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  theta_distribution <span class="op">=</span> <span class="st">"default"</span>,</span>
<span>  uncertainty_interval_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"wald"</span>, <span class="st">"percentile"</span><span class="op">)</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  num_cores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  confidence_level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  return_replicates <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  is_paf <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>design</dt>
<dd><p>(<code>survey.design</code>, <code>data.frame</code>,<code>tibble</code>, or <code>svyrep.design</code>) survey data
structure. If data comes from a survey set the <code>design</code> with <code><a href="https://rdrr.io/pkg/survey/man/svydesign.html" class="external-link">survey::svydesign()</a></code>. It can
also support a <code><a href="https://rdrr.io/pkg/survey/man/svrepdesign.html" class="external-link">survey::svrepdesign()</a></code> design if your survey comes with replicates.
Finally, the model can also accommodate a <code>data.frame</code> or <code>tibble</code> with weights assuming
simple random sampling without replacement.</p></dd>


<dt>theta</dt>
<dd><p>(<code>vector</code>/<code>double</code>) parameters of the relative risk function <code>rr</code>.</p></dd>


<dt>rr</dt>
<dd><p>(<code>function</code>) relative risk function with two parameters: a <code>data.frame</code> called
<code>X</code> containing the individual-level exposure and covariates, and <code>theta</code> (in that order).</p></dd>


<dt>cft</dt>
<dd><p>(<code>function</code>) counterfactual function that takes a <code>data.frame</code>, <code>X</code>, of
individual-level exposure and covariates and returns a new <code>data.frame</code> of individual-level
counterfactual exposure and covariates.</p></dd>


<dt>additional_theta_arguments</dt>
<dd><p>any additional information on <code>theta</code> utilized
for obtaining bootstrap samples from the paramter. Options are:</p><ul><li><p>(<code>double</code>) the <strong>variance</strong> of <code>theta</code> if <code>theta</code> is
one dimensional and asymptotical normality is assumed (default).</p></li>
<li><p>(<code>vector</code>) the <strong>variances</strong> of each entry of <code>theta</code> if <code>theta</code> is
n-dimensional and its entries are uncorrelated and asymptotical normality is assumed (default).</p></li>
<li><p>(<code>matrix</code>) the <strong>variance-covariance</strong> matrix of <code>theta</code> if <code>theta</code> is
n-dimensional and its entries are correlated and asymptotical normality is assumed (default).</p></li>
<li><p>any list of arguments to pass via <code><a href="https://rdrr.io/r/base/do.call.html" class="external-link">base::do.call()</a></code> to <code>theta_distribution</code> to
simulate samples from <code>theta</code> if <code>theta</code> is not assumed to be asymptotically normally
distributed.</p></li>
</ul><p><strong>Optional</strong></p></dd>


<dt>n_bootstrap_samples</dt>
<dd><p>(<code>double</code>) number of bootstrap samples. If a <code>svyrep.design</code> is passed
as an argument, then <code>n_bootstrap_samples</code> represents the number of number of replicates in
the design.</p></dd>


<dt>theta_distribution</dt>
<dd><p>(<code>function</code>) random number generator that follows
the distribution of the estimator <code>theta</code>. By default, <code>theta</code> is assumed to be asymptotically
normal and thus <code>theta_distribution</code> is set to <code><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">mvtnorm::rmvnorm()</a></code> with
variance given by <code>additional_theta_arguments</code>. The number of simulations for the
<code>theta_distribution</code> function must be parametrized by a parameter of name <code>n</code>.</p></dd>


<dt>uncertainty_interval_type</dt>
<dd><p>(<code>string</code>) either <code>'wald'</code> (recommended) or <code>'percentile'</code> for
uncertainty intervals based upon the bootstrap's percentile or the Wald-type approximation
(see confidence interval section)</p></dd>


<dt>parallel</dt>
<dd><p>(<code>boolean</code>) Flag indicating whether or not to do computations in parallel.
Default is <code>TRUE</code>.</p></dd>


<dt>num_cores</dt>
<dd><p>(<code>int</code>) Number of cores; defaults to <code><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">parallel::detectCores()</a></code>.</p></dd>


<dt>confidence_level</dt>
<dd><p>(<code>double</code>) Confidence level for the uncertainty interval.
Defaults to <code>0.95</code>.</p></dd>


<dt>return_replicates</dt>
<dd><p>(<code>boolean</code>) Whether to return the simulated impact fractions
or not.</p></dd>


<dt>is_paf</dt>
<dd><p>(<code>boolean</code>) Whether the function being estimated is the Population
Attributable Fraction (<code>is_paf = TRUE</code>) or the Potential Impact Fraction
(<code>is_paf = FALSE</code>)</p></dd>


<dt>weights</dt>
<dd><p>(<code>vector</code>) If you are not following the recommended version and use a
<code>svydesign</code> object for the design you can still use <code>weights</code> to associate
weights to your estimation. Beware that it might not give accurate estimations of the variance
nor the uncertainty intervals.</p></dd>


<dt>...</dt>
<dd><p>Additional parameters for <code><a href="https://bschneidr.github.io/svrep/reference/as_bootstrap_design.html" class="external-link">svrep::as_bootstrap_design()</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="confidence-intervals">Confidence Intervals<a class="anchor" aria-label="anchor" href="#confidence-intervals"></a></h2>
    


<p>Confidence intervals are estimated via the two methods specified
by Arnab (2017)
.</p><ol><li><p><strong>Wald-type confidence intervals</strong> (which are more precise) are of the form:
\[
\widehat{\text{PIF}} \pm t_{1 - \alpha/2}
\sqrt{\widehat{\text{Var}}_{\text{B}}\big[\widehat{\text{PIF}}\big]}
\]
where <em></em>\(t_{1 - \alpha/2}\) stands for the percent points at level <em></em>\(1 - \alpha/2\)
of Student's t-distribution, and
<em></em>\(\widehat{\text{Var}}_{\text{B}}\big[\widehat{\text{PIF}}\big]\)
represents the estimated variance (via bootstrap) of the potential impact fraction estimator.</p></li>
<li><p><strong>Percentile confidence intervals</strong> (less precise) are of the form:
\[
\Big[\widehat{\text{PIF}}_{\text{B},\alpha/2}, \widehat{\text{PIF}}_{\text{B},1-\alpha/2}\Big]
\]
where <em></em>\(\widehat{\text{PIF}}_{\text{B},k}\) represents the kth sample quantile
from the bootstrap simulation of the potential impact fraction estimator.</p></li>
</ol></div>
    <div class="section level2">
    <h2 id="additional-parallelization-options">Additional parallelization options<a class="anchor" aria-label="anchor" href="#additional-parallelization-options"></a></h2>
    

<p>By default the function uses <a href="https://rdrr.io/pkg/foreach/man/foreach.html" class="external-link">foreach::foreach</a> to parallelize creating a cluster
via <a href="https://rdrr.io/pkg/doParallel/man/registerDoParallel.html" class="external-link">doParallel::registerDoParallel</a>. For finner parallelization control you can do:</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co">#Create the cluster outside using whatever you want</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>myCluster <span class="ot">&lt;-</span> parallel<span class="sc">::</span><span class="fu">makeCluster</span>(<span class="dv">3</span>, <span class="at">type =</span> <span class="st">"PSOCK"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="co">#Register the cluster</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>doParallel<span class="sc">::</span><span class="fu">registerDoParallel</span>(myCluster)</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="co">#Call the function using parallel = TRUE to use %dopar% and num_cores = NULL to avoid setting</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="fu">pif</span>(..., <span class="at">parallel =</span> <span class="cn">TRUE</span>, <span class="at">num_cores =</span> <span class="cn">NULL</span>)</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="co">#Stop the cluster</span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>doParallel<span class="sc">::</span><span class="fu">stopCluster</span>(myCluster)</span></code></pre><p></p></div>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Arnab R (2017).
“Survey sampling theory and applications.”
In chapter Variance Estimation: Complex Survey Designs.
Academic Press.<br><br> Chan CE, Zepeda-Tello R, Camacho-García-Formentí D, Cudhea F, Meza R, Rodrigues E, Spiegelman D, Barrientos-Gutierrez T, Zhou X (2023).
“Nonparametric Estimation of the Potential Impact Fraction and Population Attributable Fraction with Individual-Level and Aggregated Data.”
2207.03597.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="paf.html">paf()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Use the ensanut dataset</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ensanut</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># EXAMPLE 1</span></span></span>
<span class="r-in"><span><span class="co"># Setup the survey design</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>survey.lonely.psu <span class="op">=</span> <span class="st">"adjust"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">design</span> <span class="op">&lt;-</span> <span class="fu">survey</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/survey/man/svydesign.html" class="external-link">svydesign</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ensanut</span>, ids <span class="op">=</span> <span class="op">~</span><span class="fl">1</span>, weights <span class="op">=</span> <span class="op">~</span><span class="va">weight</span>, strata <span class="op">=</span> <span class="op">~</span><span class="va">strata</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">rr</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">X</span>, <span class="va">theta</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="va">theta</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">X</span><span class="op">[</span>, <span class="st">"age"</span><span class="op">]</span> <span class="op">+</span> <span class="va">theta</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="va">X</span><span class="op">[</span>, <span class="st">"systolic_blood_pressure"</span><span class="op">]</span> <span class="op">/</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="va">cft</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">X</span><span class="op">[</span>, <span class="st">"systolic_blood_pressure"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">X</span><span class="op">[</span>, <span class="st">"systolic_blood_pressure"</span><span class="op">]</span> <span class="op">-</span> <span class="fl">5</span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="fu">pif</span><span class="op">(</span><span class="va">design</span>,</span></span>
<span class="r-in"><span>  theta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.05</span>, <span class="fl">1.38</span><span class="op">)</span><span class="op">)</span>, <span class="va">rr</span>, <span class="va">cft</span>,</span></span>
<span class="r-in"><span>  additional_theta_arguments <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.03</span><span class="op">)</span>, n_bootstrap_samples <span class="op">=</span> <span class="fl">10</span>, parallel <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Point</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.01493412</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Interval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Lower        Upper </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.005071922  0.034940153 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Confidence</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Standard_Deviation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.008978811</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Uncertainty interval type`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "wald"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># EXAMPLE 2</span></span></span>
<span class="r-in"><span><span class="co"># Now do the same but using a replicate design</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>survey.lonely.psu <span class="op">=</span> <span class="st">"adjust"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">rep_design</span> <span class="op">&lt;-</span> <span class="fu">svrep</span><span class="fu">::</span><span class="fu"><a href="https://bschneidr.github.io/svrep/reference/as_bootstrap_design.html" class="external-link">as_bootstrap_design</a></span><span class="op">(</span><span class="va">design</span>, replicates <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">pif</span><span class="op">(</span><span class="va">rep_design</span>,</span></span>
<span class="r-in"><span>  theta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.05</span>, <span class="fl">1.38</span><span class="op">)</span><span class="op">)</span>, <span class="va">rr</span>, <span class="va">cft</span>,</span></span>
<span class="r-in"><span>  additional_theta_arguments <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.03</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Point</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.01317647</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Interval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Lower        Upper </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.007221684  0.033574619 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Confidence</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Standard_Deviation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.009154794</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Uncertainty interval type`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "wald"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Rodrigo Zepeda-Tello, Dalia Camacho-García-Formentí, Francisco Reyes.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

